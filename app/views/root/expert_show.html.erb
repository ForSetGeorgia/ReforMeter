<%
page_title t('.title', time: @quarter.time_period)
@do_not_use_default_page_layout = true
%>

<div class='contentSection mod-overlap-top-image'>

  <header class='contentSection-header'>

    <h1 class='heading'>
      <%= yield(:page_title) %>
    </h1>

    <% if @active_quarters %>
      <div>

        <%= t('shared.common.change_time') %>:
        <select class='js-become-select2 js-change-expert-time-period' data-base-url='<%= experts_path %>'>

          <% @active_quarters.each do |active_quarter| %>
            <option value='<%= active_quarter[1] %>' <% if @quarter.slug == active_quarter[1] %>selected<% end %>>
              <%= active_quarter[0] %>
            </option>
          <% end %>

        </select>

      </div>
    <% end %>

  </header>

  <div class='contentSection-body'>

    <div class='expertShowPage-summaryGaugesContainer'>
      <% if @quarter.expert_survey.summary %>
        <div class='expertShowPage-summaryGaugesContainer-summary'>
          <%= simple_format_no_tags(@quarter.expert_survey.summary) %>
        </div>
      <% end %>

      <section class='expertShowPage-summaryGaugesContainer-gauges'>

        <div class='js-become-expert-overall-chart' style="width: 250px; height: 220px;"></div>

        <div class='expertShowPage-summaryGaugesContainer-gauges-small'>

          <div class='js-become-expert-performance-chart' style="width: 125px; height: 220px;"></div>

          <div class='js-become-expert-goals-chart' style="width: 125px; height: 220px;"></div>

          <div class='js-become-expert-progress-chart' style="width: 125px; height: 220px;"></div>

        </div>

      </section>
    </div>

    <div>
      <ul class='tabList mod-with-separator js-act-as-tab-list'>

        <li class='tabList-item'>
          <button class='tabList-item-button is-selected js-act-as-tab-list-button' data-selects-tab-content-panel-id='chart'>
            <%= t('.header.chart') %>
          </button>
        </li>

        <li class='tabList-item'>
          <button class='tabList-item-button js-act-as-tab-list-button' data-selects-tab-content-panel-id='methodology'>
            <%= t('.header.methodology') %>
          </button>
        </li>

      </ul>

      <div class="tabContent js-act-as-tab-content">

        <div class='tabContent-panel is-selected js-act-as-tab-content-panel' id='chart'>
          insert chart here
        </div>

        <div class='tabContent-panel js-act-as-tab-content-panel' id='methodology'>
          <% if @methodology_expert %>
            <div>
              <%= simple_format_no_tags(@methodology_expert.content) %>
            </div>
          <% else %>
            <p>
             <%= t('.no_methodology') %>
            </p>
          <% end %>
        </div>

      </div>

    </div>

  </div>

</div>

<div class='expertShowPage-findingsSidebarContainer'>

  <div class='contentSection'>

    <header class='contentSection-header mod-no-padding'>
      <ul class='tabList mod-header js-act-as-tab-list'>

        <li class='tabList-item'>
          <button class='tabList-item-button is-selected js-act-as-tab-list-button' data-selects-tab-content-panel-id='findings'>
            <%= t('.header.findings') %>
          </button>
        </li>

        <li class='tabList-item'>
          <button class='tabList-item-button js-act-as-tab-list-button' data-selects-tab-content-panel-id='experts'>
            <%= t('.header.experts') %>
          </button>
        </li>

      </ul>
    </header>

    <div class='contentSection-body'>

      <div class="tabContent js-act-as-tab-content">

        <div class='tabContent-panel is-selected js-act-as-tab-content-panel' id='findings'>
          <% if @quarter.expert_survey.details %>
            <div>
              <%= simple_format_no_tags(@quarter.expert_survey.details) %>
            </div>
          <% else %>
            <p>
              <%= t('.no_details') %>
            </p>
          <% end %>
        </div>

        <div class='tabContent-panel js-act-as-tab-content-panel' id='experts'>
          <h3 class='heading mod-vertical-margin'>
            The Experts
          </h3>

          <% if @quarter.expert_survey.experts %>
            <ul class='expertList'>
              <% @quarter.expert_survey.experts.each do |expert| %>

                <li class='expertList-item'>

                  <h4 class='expertList-item-heading'>
                    <%= expert.name %>
                  </h4>

                  <%= image_tag(expert.avatar.url('100x100'),
                                class: 'expertList-item-image') %>

                  <% if expert.bio %>
                    <%= simple_format_no_tags(expert.bio) %>
                  <% end %>

                </li>

              <% end %>
            </ul>

          <% else %>
            <p>
             <%= t('.no_experts') %>
            </p>
          <% end %>
        </div>

      </div>

    </div>
  </div>

  <% if @news.present? %>
    <div class='expertShowPage-findingsSidebarContainer-sidebar'>
      <aside>
        <h2 class='u-hide-visually'>
          Expert News
        </h2>

        <% @news.each do |news| %>
          <% if news.image.exists? %>
            <div class='contentSection'>
              <%= image_tag(
                    news.image.url('360x200'),
                    class: 'responsiveImage') %>

              <div class='contentSection-header'>

                <h3 class='heading'>
                  <%= link_to news.title,
                              news.url,
                              target: :blank %>
                </h3>

              </div>

              <div class='contentSection-body mod-no-top-border'>
                <%= simple_format_no_tags(news.content) %>
              </div>

            </div>
          <% else %>
            <div class='contentSection'>

              <header class='contentSection-header'>
                <h3 class='heading'>
                  <%= link_to news.title,
                              news.url,
                              target: :blank %>
                </h3>
              </header>

              <div class='contentSection-body'>
                <%= simple_format_no_tags(news.content) %>
              </div>

            </div>
          <% end %>

        <% end %>

      </aside>
    </div>
  <% end %>

</div>
